// ä¿®æ”¹å¾Œçš„ failAndFix å‡½å¼é‚è¼¯
function failAndFix(reason) {
    log(`<span style="color:#f87171">å¤±æ•—ï¼š${reason}</span>`);
    
    if (steps[currentNoteIndex]) {
        const target = steps[currentNoteIndex];
        
        if (currentNoteIndex === 0) {
            // ç­–ç•¥ Aï¼šè®“çƒçš„èµ·å§‹ä½ç½®å¾€å³ç§» (ä½ æåˆ°çš„æ ¸å¿ƒéœ€æ±‚)
            // æˆ‘å€‘å¯ä»¥æ–°å¢ä¸€å€‹è®Šæ•¸ ballStartXï¼Œæ¯æ¬¡å¤±æ•—å°± +20
            ballStartX += 20; 
            
            // ç­–ç•¥ Bï¼šåŒæ™‚å°‡ç¬¬ä¸€å€‹æ¿å­å¾€å·¦ç§»ï¼Œé›™ç®¡é½Šä¸‹
            target.x -= 30;
            target.y -= 10; // ç¨å¾®æŠ¬é«˜é˜²æ­¢æ‰å¤ªå¿«
            
            log(`ğŸ”§ <span style="color:#60a5fa">é¦–éŸ³æ ¡æº–ï¼šçƒèµ·å§‹é»å³ç§»è‡³ ${ballStartX}pxï¼Œæ¿å­å·¦ç§»</span>`);
        } else {
            // å¾ŒçºŒéŸ³ç¬¦çš„ä¿®æ­£é‚è¼¯ä¿æŒä¸è®Š...
            target.x -= 30;
            target.y -= 40;
        }
    }

    attempts++;
    document.getElementById('attemptCount').innerText = attempts;
    setTimeout(resetBall, 200); // ç¸®çŸ­é‡è©¦é–“éš”ï¼ŒåŠ å¿«å­¸ç¿’æ•ˆç‡
}

// è®Šæ›´å¾Œçš„ resetBall å‡½å¼
let ballStartX = 50; // å…¨åŸŸè®Šæ•¸ï¼Œç´€éŒ„å­¸ç¿’å¾Œçš„èµ·å§‹ä½ç½®

function resetBall() {
    ball = { 
        x: ballStartX, // ä½¿ç”¨å­¸ç¿’å¾Œçš„ x åº§æ¨™
        y: 120, 
        vx: VX + (attempts * 0.1), // éš¨å˜—è©¦æ¬¡æ•¸å¾®å¢åˆé€Ÿï¼Œå¢åŠ è¦†è“‹ç¯„åœ
        vy: 0, 
        r: 15 
    };
    currentNoteIndex = 0;
    camera = { x: 0, y: 0 };
}
